{
  "query": "-- Email Templates table for MonOPCO v3\nCREATE TABLE IF NOT EXISTS email_templates (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,\n  nom VARCHAR(255) NOT NULL,\n  sujet TEXT NOT NULL,\n  corps TEXT NOT NULL,\n  placeholders TEXT[] DEFAULT ARRAY[]::TEXT[],\n  created_at TIMESTAMPTZ DEFAULT NOW(),\n  updated_at TIMESTAMPTZ DEFAULT NOW()\n);\n\n-- Index for faster queries\nCREATE INDEX IF NOT EXISTS idx_email_templates_user_id ON email_templates(user_id);\n\n-- RLS Policies\nALTER TABLE email_templates ENABLE ROW LEVEL SECURITY;\n\n-- Users can view own templates\nCREATE POLICY \"Users can view own email templates\"\n  ON email_templates FOR SELECT\n  USING (auth.uid() = user_id);\n\n-- Users can create own templates\nCREATE POLICY \"Users can create own email templates\"\n  ON email_templates FOR INSERT\n  WITH CHECK (auth.uid() = user_id);\n\n-- Users can update own templates\nCREATE POLICY \"Users can update own email templates\"\n  ON email_templates FOR UPDATE\n  USING (auth.uid() = user_id);\n\n-- Users can delete own templates\nCREATE POLICY \"Users can delete own email templates\"\n  ON email_templates FOR DELETE\n  USING (auth.uid() = user_id);\n\n-- Trigger to update updated_at timestamp\nCREATE OR REPLACE FUNCTION update_email_templates_updated_at()\nRETURNS TRIGGER AS $$\nBEGIN\n  NEW.updated_at = NOW();\n  RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE TRIGGER email_templates_updated_at\n  BEFORE UPDATE ON email_templates\n  FOR EACH ROW\n  EXECUTE FUNCTION update_email_templates_updated_at();",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway02.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 3GB82FZGmc2ADuw.36eb2fc289fb --database dyCf5mo5excqY76Ao4aBkM --execute -- Email Templates table for MonOPCO v3\nCREATE TABLE IF NOT EXISTS email_templates (\n  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,\n  nom VARCHAR(255) NOT NULL,\n  sujet TEXT NOT NULL,\n  corps TEXT NOT NULL,\n  placeholders TEXT[] DEFAULT ARRAY[]::TEXT[],\n  created_at TIMESTAMPTZ DEFAULT NOW(),\n  updated_at TIMESTAMPTZ DEFAULT NOW()\n);\n\n-- Index for faster queries\nCREATE INDEX IF NOT EXISTS idx_email_templates_user_id ON email_templates(user_id);\n\n-- RLS Policies\nALTER TABLE email_templates ENABLE ROW LEVEL SECURITY;\n\n-- Users can view own templates\nCREATE POLICY \"Users can view own email templates\"\n  ON email_templates FOR SELECT\n  USING (auth.uid() = user_id);\n\n-- Users can create own templates\nCREATE POLICY \"Users can create own email templates\"\n  ON email_templates FOR INSERT\n  WITH CHECK (auth.uid() = user_id);\n\n-- Users can update own templates\nCREATE POLICY \"Users can update own email templates\"\n  ON email_templates FOR UPDATE\n  USING (auth.uid() = user_id);\n\n-- Users can delete own templates\nCREATE POLICY \"Users can delete own email templates\"\n  ON email_templates FOR DELETE\n  USING (auth.uid() = user_id);\n\n-- Trigger to update updated_at timestamp\nCREATE OR REPLACE FUNCTION update_email_templates_updated_at()\nRETURNS TRIGGER AS $$\nBEGIN\n  NEW.updated_at = NOW();\n  RETURN NEW;\nEND;\n$$ LANGUAGE plpgsql;\n\nCREATE TRIGGER email_templates_updated_at\n  BEFORE UPDATE ON email_templates\n  FOR EACH ROW\n  EXECUTE FUNCTION update_email_templates_updated_at();",
  "returncode": 1,
  "logs": [
    "ERROR 1064 (42000) at line 2: You have an error in your SQL syntax; check the manual that corresponds to your TiDB version for the right syntax to use line 2 column 10 near \"UUID PRIMARY KEY DEFAULT gen_random_uuid(),",
    "  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,",
    "  nom VARCHAR(255) NOT NULL,",
    "  sujet TEXT NOT NULL,",
    "  corps TEXT NOT NULL,",
    "  placeholders TEXT[] DEFAULT ARRAY[]::TEXT[],",
    "  created_at TIMESTAMPTZ DEFAULT NOW(),",
    "  updated_at TIMESTAMPTZ DEFAULT NOW()",
    ")\""
  ]
}